---
title: "5.4 如何实现条件推送"
date: 2023-03-27T20:30:35+08:00
---

使用HTTP/2推送的风险是推送浏览器不需要的资源

### 5.4.1 在服务端跟踪推送的资源

需要记状态, 比较复杂

- 会遇到资源限制
- 负载均衡问题

### 5.4.2 使用HTTP条件请求

客户端发送一个if-modified-since或者etag首部，而引用这个CSS的页面已经在浏览器的缓存中，但已过期。

### 5.4.3 使用基于cookie的推送

在客户端记录哪些资源已经被推送。cookie是做这个的理想载体，当然也可以使用LocalStorage和SessionStorage。

### 5.4.4 使用缓存摘要

缓存摘要是一个提议，浏览器用它来告诉服务器缓存里有什么内容。当连接建立时，浏览器发送一个CACHE_DIGEST帧，列出当前域名（或者本连接授权的其他域名）
的HTTP缓存中的所有资源。
