---
title: "5.3 HTTP/2推送在浏览器中如何运作"
date: 2023-03-26T12:13:30+08:00
---

具体和实现有关, 服务器推送的资源, 大多数浏览器不会立即使用, 而是放到缓存中, 如果浏览器需要某资源先去缓存中查找.

### 5.3.1 查看推送缓存如何工作

- 推送的资源存放在单独的内存中（HTTP/2推送缓存），等待浏览器请求，而后它们会被加载到页面中。
- 如果设置了缓存首部，则在后来使用它们时它们照旧会被保存到浏览器的HTTP缓存中。
- 基于Chromium的浏览器不会缓存不受信任的HTTP/2推送
- 浏览器可能先去HTTP缓存中查找资源, 然后是HTTP/2推送缓存

图5.15　浏览器和HTTP/2推送的交互

![](https://res.weread.qq.com/wrepub/epub_32517945_184)

图5.16　在Chrome中对未声明的推送资源进行跟踪

![](https://res.weread.qq.com/wrepub/epub_32517945_185)

- **HTTP/2推送缓存和连接绑定，这意味着如果连接关闭，推送资源也就无法使用了。**
- **如果使用另外一个连接，也用不到推送的资源。**
- 当资源从连接的推送缓存中被“认领”并拿出后，就不能再从推送缓存中使用它了。

### 5.3.2 使用RST_STREAM拒绝推送

在服务端收到RST_STREAM帧并做出响应之前，可能整个推送的资源已经发完了。

- 只有在浏览器知道它不需要推送的资源时，RST_STREAM帧才有用
