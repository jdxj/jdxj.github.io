---
title: "第6章 循环"
date: 2023-07-01T14:37:08+08:00
---

## 6.1 while语句

while (表达式) 语句

- 圆括号是强制要求的

```c
while (i > 0) {
  printf("T minus %d and counting\n", i);
  i--;
}
```

### 无限循环

while (1)...

## 6.2 do语句

do 语句 while (表达式);

- 控制表达式的外面也必须有圆括号

```c
i = 10;
do {
  printf("T minus %d and counting\n", i);
  --i;
} while (i > 0);
```

## 6.3 for语句

for (表达式1; 表达式2; 表达式3) 语句

for循环总可以用等价的while循环替换：

```c
表达式1;
while (表达式2) {
  语句
  表达式3;
}
```

### 6.3.1 for语句的惯用法

```c
// 从0向上加到n-1
for ( i = 0; i < n; i++) ...
// 从1向上加到n
for ( i = 1; i <= n; i++) ...
// 从n-1向下减到0
for ( i = n - 1; i >= 0; i--) ...
// 从n向下减到1
for ( i = n; i > 0; i--) ...
```

### 6.3.2 在for语句中省略表达式

C语言允许省略任意或全部的表达式

如果省略第二个表达式，那么它默认为真值，因此for语句不会终止

```c
for ( ; ; )...
```

### 6.3.3 C99中的for语句

for语句的第一个表达式可以替换为一个声明

```c
for (int i = 0; i < n; i++)
  ...
```

- 变量i不需要在该语句前进行声明。事实上，如果变量i在之前已经进行了声明，这个语句将创建一个新的i且该值仅用于循环内。
- for语句声明的变量不可以在循环外访问
- for语句可以声明多个变量，只要它们的类型相同

```c
for (int i = 0,  j = 0; i < n; i++)
...
```

### 6.3.4 逗号运算符

表达式1, 表达式2

- 第一步，计算表达式1并且扔掉计算出的值。第二步，计算表达式2，把这个值作为整个表达式的值。
- 对表达式1的计算应该始终会有副作用；如果没有，那么表达式1就没有了存在的意义。

逗号运算符允许将两个表达式“粘贴”在一起构成一个表达式。（注意与复合语句的相似之处，后者允许我们把一组语句当作一条语句来使用。）

```c
for (sum = 0, i = 1; i <= N; i++)
  sum += i;
```

## 6.4 退出循环

### 6.4.1 break语句

```c
for (d = 2; d < n; d++)
  if (n % d == 0)
    break;
if (d < n)
  printf("%d is divisible by %d\n", n, d);
else
  printf("%d is prime\n", n);
```

break语句只能跳出一层嵌套

### 6.4.2 continue语句

break语句刚好把程序控制转移到循环体末尾之后，而continue语句刚好把程序控制转移到循环体末尾之前。

- continue语句只能用于循环

```c
n = 0;
sum = 0;
while (n < 10) {
  scanf("%d", &i);
  if (i == 0)
    continue;
  sum += i;
  n++;
  /* continue jumps to here */
}
```

### 6.4.3 goto语句

goto语句则可以跳转到函数中任何有标号的语句处。

- C99增加了一条限制：goto语句不可以用于绕过变长数组的声明。

标识符 : 语句

goto 标识符;

```c
for (d = 2; d < n; d++)
  if (n % d == 0)
    goto done;
done:
if (d < n)
  printf("%d is divisible by %d\n", n, d);
else
  printf("%d is prime\n", n);
```

goto语句解决了退出多层问题

```c
while (...) {
  switch (...) {
    ...
    goto loop_done;     /* break won't work here */
    ...
  }
}
loop_done: ...
```

## 6.5 空语句

```c
i = 0;  ;  j = 1;
```

`;`不要放到for的同一行, 否则会混淆后面语句为循环体

```c
for (d = 2; d < n && n % d != 0; d++);
if (d < n)
  printf("%d is divisible by %d\n", n, d);
```
