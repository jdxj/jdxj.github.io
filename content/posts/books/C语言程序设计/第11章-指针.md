---
title: "第11章 指针"
date: 2023-07-05T11:59:48+08:00
---

## 11.1 指针变量

![](https://res.weread.qq.com/wrepub/epub_31359737_458)

程序中的每个变量占有一个或多个字节内存，把第一个字节的地址称为是变量的地址。

### 指针变量的声明

```c
int *p;
int i, j, a[10], b[20], *p, *q;
```

C语言要求每个指针变量只能指向一种特定类型（引用类型）的对象：

```c
int *p;      /* points only to integers    */
double *q;   /* points only to doubles     */
char *r;     /* points only to characters  */
```

指针变量甚至可以指向另一个指针

## 11.2 取地址运算符和间接寻址运算符

声明指针变量是为指针留出空间，但是并没有把它指向对象：

```c
int *p;    /* points nowhere in particular */
```

在使用前初始化p是至关重要的。一种初始化指针变量的方法是使用&运算符把某个变量的地址赋给它，或者更常采用左值

```c
int i, *p;
...
p = &i;

int i;
int *p = &i;

int i, *p = &i;
```

### 11.2.2 间接寻址运算符

```c
printf("%d\n", *p);
```

如果指针变量p没有初始化，那么试图使用p的值会导致未定义的行为

```c
int *p;
printf("%d", *p);  /*** WRONG ***/

int *p;
*p = 1;  /*** WRONG ***/
```

## 11.3 指针赋值

```c
int i, j, *p, *q;
p = &i;
q = p;
```

## 11.4 指针作为参数

```c
void decompose(double x, long *int_part, double *frac_part)
{
  *int_part = (long) x;
  *fract_part = x - *int_part;
}

decompose(3.14159, &i, &d);
```

虽然scanf函数的实际参数必须是指针，但并不总是需要&运算符。

```c
int i, *p;
...
p = &i;
scanf("%d", p);

scanf("%d", &p);    /*** WRONG ***/
```

### 用const保护参数

```c
void f(const int *p)
{
  *p = 0;   /*** WRONG ***/
}
```

这一用法表明p是指向“常整数”的指针。试图改变*p是编译器会检查的一种错误。

## 11.5 指针作为返回值

```c
int *max(int *a, int *b)
{
  if (*a > *b)
    return a;
  else
    return b;
}

int *p, i, j;
...
p = max(&i, &j);
```

函数也可以返回指向外部变量或指向声明为static的局部变量的指针。

**永远不要返回指向自动局部变量的指针**

```c
int *f(void)
{
 int i;
 ...
 return &i;
}
```

指针可以指向数组元素

```c
int *find_middle(int a[], int n) {
  return &a[n/2];
}
```
