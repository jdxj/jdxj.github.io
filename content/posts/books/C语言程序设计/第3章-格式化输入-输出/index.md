---
title: "第3章 格式化输入/输出"
date: 2023-07-01T09:09:35+08:00
---

## 3.1 printf函数

```c
printf(格式串, 表达式1, 表达式2, ...);
```

- 调用printf函数一次可以打印的值的个数没有限制。
- C语言编译器不会检测格式串中转换说明的数量是否和输出项的数量相匹配。
- C语言编译器也不检测转换说明是否适合要显示项的数据类型。

### 3.1.1 转换说明

转换数字

```c
// 格式
%m.px
```

- m: 最小字段宽度
- p: 精度
- x: 进行哪种转换
  - d: 表示十进制（基数为10）形式的整数。 p指明了待显示的数字的最少个数（必要时在数前加上额外的零）；如果省略p，则默认它的值为1
  - e: 表示指数（科学记数法）形式的浮点数。p指明了小数点后应该出现的数字的个数（默认值为6）。如果p为0，则不显示小数点。
  - f: 表示“定点十进制”形式的浮点数，没有指数。p的含义与在说明符e中的一样。
  - g: 表示指数形式或者定点十进制形式的浮点数，形式的选择根据数的大小决定。p说明可以显示的有效数字（没有小数点后的数字）的最大数量。与转换说
    明符f不同，g的转换将不显示尾随的零。此外，如果要显示的数值没有小数点后的数字，g就不会显示小数点。

{{< embedcode c "tprintf.c" >}}

### 3.1.2 转义序列

```c
printf("\"Hello!\"");
printf("\\");   /* prints one \ character */
```

## 3.2 scanf函数

```c
int i, j;
float x, y;
scanf ("%d%d%f%f", &i, &j, &x, &y);

// 输入
1  -20  .3  -4.0e3
```

通常把符号&放在scanf函数调用中每个变量的前面。符号&常常（但不总是）是需要的，记住使用它是程序员的责任。

### 3.2.1 scanf函数的工作方法

在寻找数的起始位置时，scanf函数会忽略空白字符（white-space character，包括空格符、水平和垂直制表符、换页符和换行符）。因此，我们可以把数
字放在同一行或者分散在几行内输入。

```c
scanf("%d%d%f%f", &i, &j, &x, &y);

// 输入
  1
-20   .3
   -4.0e3
```

在用于scanf函数时，转换说明%e、%f和%g是可以互换的，这3种转换说明在识别浮点数方面都遵循相同的规则。

**当scanf函数遇到一个不可能属于当前项的字符时，它会把此字符“放回原处”**，以便在扫描下一个输入项或者下一次调用scanf函数时再次读入。

### 3.2.2 格式串中的普通字符

- 空白字符。当在格式串中遇到一个或多个连续的空白字符时，scanf函数从输入中重复读空白字符直到遇到一个非空白字符（把该字符“放回原处”）为止。
  格式串中空白字符的数量无关紧要，格式串中的一个空白字符可以与输入中任意数量的空白字符相匹配(包括零个)。
- 其他字符。当在格式串中遇到非空白字符时，scanf函数将把它与下一个输入字符进行比较。如果两个字符相匹配，那么scanf函数会放弃输入字符而继续处
  理格式串。如果两个字符不匹配，那么scanf函数会把不匹配的字符放回输入中，然后异常退出，而不进一步处理格式串或者从输入中读取字符。

### 3.2.3 易混淆的printf函数和scanf函数

```c
printf("%d %d\n", &i, &j);   /*** WRONG***/

// scanf函数首先寻找输入中的整数，把这个整数存入变量i中；
// 然后，scanf函数将试图把逗号与下一个输入字符相匹配。
// 如果下一个输入的字符是空格而不是逗号，那么scanf函数将终止操作，而不再读取变量j的值。
scanf("%d, %d", &i, &j);
```

printf格式串经常以\n结尾，但是在scanf格式串末尾放置换行符通常是一个坏主意。对scanf函数来说，格式串中的换行符等价于空格，两者都会引发scanf
函数提前进入到下一个非空白字符。例如，如果格式串是"%d\n"，那么scanf函数将跳过空白字符，读取一个整数，然后跳到下一个非空白字符处。像这样的格
式串可能会**导致交互式程序一直挂起**直到用户输入一个非空白字符为止。
