---
title: "第8章 数组"
date: 2023-07-04T11:30:18+08:00
---

## 8.1 一维数组

```c
int a[10];
```

因为程序以后改变时可能需要调整数组的长度，所以较好的方法是用宏来定义数组的长度：

```c
#define N 10
...
int a[N];
```

### 8.1.1 数组下标

```c
for (i = 0; i < N; i++)
  scanf("%d", &a[i]);       /* reads data into a */

a[i+j*10] = 0;
```

### 8.1.2 数组初始化

```c
int a[10] = {1, 2, 3, 4, 5, 6, 7, 8, 9, 10};

int a[10] = {1, 2, 3, 4, 5, 6};
  /* initial value of a is {1, 2, 3, 4, 5, 6, 0, 0, 0, 0} */

int a[10] = {0};
  /* initial value of a is {0, 0, 0, 0, 0, 0, 0, 0, 0, 0} */

int a[] = {1, 2, 3, 4, 5, 6, 7, 8, 9, 10};
```

### 8.1.3 指定初始化式(c99)

```c
int a[15] = {[2] = 29, [9] = 7, [14] = 48};
int a[15] = {[14] = 48 , [9] = 7, [2] = 29};

// 编译器将根据最大的指示符推断出数组的长度, 24
int b[] = {[5] = 10 , [23] = 13, [11] = 36, [15] = 29};

int c[10] = {5, 1, 9, [4] = 3, 7, 2, [8] = 6};
```

### 8.1.4 对数组使用sizeof运算符

运算符sizeof可以确定数组的大小（字节数）

还可以用sizeof来计算数组元素（如a[0]）的大小。用数组的大小除以数组元素的大小可以得到数组的长度

```c
sizeof(a) / sizeof(a[0])

// 遍历数组
for (i = 0; i < sizeof(a) / sizeof(a[0]); i++)
  a[i] = 0;

// 可能有警告, 这里做下类型转换
for (i = 0; i < (int) (sizeof(a) / sizeof(a[0])); i++)
  a[i] = 0;
```

## 8.2 多维数组

```c
int m[5][9];
```

### 8.2.1 多维数组初始化

```c
int m[5][9] = {{1, 1, 1, 1, 1, 0, 1, 1, 1},
               {0, 1, 0, 1, 0, 1, 0, 1, 0},
               {0, 1, 0, 1, 1, 0, 0, 1, 0},
               {1, 1, 0, 1, 0, 0, 0, 1, 0},
               {1, 1, 0, 1, 0, 0, 1, 1, 1}};

int m[5][9] = {{1, 1, 1, 1, 1, 0, 1, 1, 1},
               {0, 1, 0, 1, 0, 1, 0, 1, 0},
               {0, 1, 0, 1, 1, 0, 0, 1, 0}};

int m[5][9] = {{1, 1, 1, 1, 1, 0, 1, 1, 1},
               {0, 1, 0, 1, 0, 1, 0, 1},
               {0, 1, 0, 1, 1, 0, 0, 1},
               {1, 1, 0, 1, 0, 0, 0, 1},
               {1, 1, 0, 1, 0, 0, 1, 1, 1}};

// 省略花括号会引起某些编译器产生类似“missing braces around initializer”这样的警告消息。
int m[5][9] = {1, 1, 1, 1, 1, 0, 1, 1, 1,
               0, 1, 0, 1, 0, 1, 0, 1, 0,
               0, 1, 0, 1, 1, 0, 0, 1, 0,
               1, 1, 0, 1, 0, 0, 0, 1, 0,
               1, 1, 0, 1, 0, 0, 1, 1, 1};
```

C99的指定初始化式对多维数组也有效

```c
double ident[2][2] = {[0][0] = 1.0, [1][1] = 1.0};
```

### 8.2.2 常量数组

```c
const char hex_chars[] =
  {'0', '1', '2', '3', '4', '5', '6', '7', '8', '9',
   'A', 'B', 'C', 'D', 'E', 'F'};
```

## 8.3 C99中的变长数组

```c
/* Reverses a series of numbers using a variable-length array - C99 only */
#include <stdio.h>
int main(void)
{
  int i, n;
  printf("How many numbers do you want to reverse? ");
  scanf("%d", &n);
  int a[n];  /* C99 only - length of array depends on n */
  printf("Enter %d numbers: ", n);
  for (i = 0; i < n; i++)
    scanf("%d", &a[i]);
  printf("In reverse order:");
  for (i = n - 1; i >= 0; i--)
    printf(" %d", a[i]);
  printf("\n");
  return 0;
}
```

```c
int a[3*i+5];
int b[j+k];

int c[m][n];
```

- 变长数组的主要限制是它们没有静态存储期限
- 另一个限制是变长数组没有初始化式。
