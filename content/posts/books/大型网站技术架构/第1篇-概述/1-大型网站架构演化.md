---
title: "1 大型网站架构演化"
date: 2023-07-21T14:11:31+08:00
---

## 1.1 大型网站软件系统的特点

- 高并发，大流量
- 高可用
- 海量数据
- 用户分布广泛，网络情况复杂
- 安全环境恶劣
- 需求快速变更，发布频繁
- 渐进式发展

## 1.2 大型网站架构演化发展历程

### 1.2.1 初始阶段的网站架构

图1.1 初始阶段的网站架构

![](https://res.weread.qq.com/wrepub/epub_773202_2)

应用程序、数据库、文件等所有的资源都在一台服务器上。

### 1.2.2 应用服务和数据服务分离

图1.2 应用服务和数据服务分离

![](https://res.weread.qq.com/wrepub/epub_773202_3)

应用和数据分离后整个网站使用三台服务器

- 应用服务器需要处理大量的业务逻辑，因此需要更快更强大的CPU；
- 数据库服务器需要快速磁盘检索和数据缓存，因此需要更快的硬盘和更大的内存；
- 文件服务器需要存储大量用户上传的文件，因此需要更大的硬盘。

网站又一次面临挑战：数据库压力太大导致访问延迟，进而影响整个网站的性能，用户体验受到影响。这时需要对网站架构进一步优化。

### 1.2.3 使用缓存改善网站性能

图1.3 网站使用缓存

![](https://res.weread.qq.com/wrepub/epub_773202_4)

网站使用的缓存可以分为两种

- 本地缓存的访问速度更快一些，但是受应用服务器内存限制，其缓存数据量有限，而且会出现和应用程序争用内存的情况。
- 远程分布式缓存可以使用集群的方式，部署大内存的服务器作为专门的缓存服务器，可以在理论上做到不受内存容量限制的缓存服务

单一应用服务器能够处理的请求连接有限，在网站访问高峰期，应用服务器成为整个网站的瓶颈。

### 1.2.4 使用应用服务器集群改善网站的并发处理能力

图1.4 应用服务器集群部署

![](https://res.weread.qq.com/wrepub/epub_773202_5)

对网站架构而言，只要能通过增加一台服务器的方式改善负载压力，就可以以同样的方式持续增加服务器不断改善系统性能，从而实现系统的可伸缩性。应用服务器实
现集群是网站可伸缩集群架构设计中较为简单成熟的一种

### 1.2.5 数据库读写分离

图1.5 数据库读写分离

![](https://res.weread.qq.com/wrepub/epub_773202_6)

为了便于应用程序访问读写分离后的数据库，通常在应用服务器端使用专门的数据访问模块，使数据库读写分离对应用透明。

### 1.2.6 使用反向代理和CDN加速网站响应

图1.6 网站使用反向代理和CDN加速访问

![](https://res.weread.qq.com/wrepub/epub_773202_7)

CDN和反向代理的基本原理都是缓存，区别在于

- CDN部署在网络提供商的机房，使用户在请求网站服务时，可以从距离自己最近的网络提供商机房获取数据；
- 而反向代理则部署在网站的中心机房，当用户请求到达中心机房后，首先访问的服务器是反向代理服务器，如果反向代理服务器中缓存着用户请求的资源，就将其直
  接返回给用户。

### 1.2.7 使用分布式文件系统和分布式数据库系统

图1.7 使用分布式文件和分布式数据库系统

![](https://res.weread.qq.com/wrepub/epub_773202_8)

分布式数据库是网站数据库拆分的最后手段，只有在单表数据规模非常庞大的时候才使用。不到不得已时，网站更常用的数据库拆分手段是业务分库，将不同业务的数
据库部署在不同的物理服务器上。

### 1.2.8 使用NoSQL和搜索引擎

图1.8 使用NoSQL系统和搜索引擎

![](https://res.weread.qq.com/wrepub/epub_773202_9)

NoSQL和搜索引擎都是源自互联网的技术手段，对可伸缩的分布式特性具有更好的支持。应用服务器则通过一个统一数据访问模块访问各种数据，减轻应用程序管理诸
多数据源的麻烦。

### 1.2.9 业务拆分

图1.9 应用拆分

![](https://res.weread.qq.com/wrepub/epub_773202_10)

### 1.2.10 分布式服务

图1.10 分布式服务

![](https://res.weread.qq.com/wrepub/epub_773202_11)

既然每一个应用系统都需要执行许多相同的业务操作，比如用户管理、商品管理等，那么可以将这些共用的业务提取出来，独立部署。由这些可复用的业务连接数据库，
提供共用业务服务，而应用系统只需要管理用户界面，通过分布式服务调用共用业务服务完成具体业务操作

## 1.3 大型网站架构演化的价值观

网站的价值在于它能为用户提供什么价值，在于网站能做什么，而不在于它是怎么做的，所以在网站还很小的时候就去追求网站的架构是舍本逐末，得不偿失的。小型
网站最需要做的就是为用户提供好的服务来创造价值，得到用户的认可，活下去，野蛮生长。

### 1.3.1 大型网站架构技术的核心价值是随网站所需灵活应对

大型网站架构技术的核心价值不是从无到有搭建一个大型网站，而是能够伴随小型网站业务的逐步发展，慢慢地演化成一个大型网站。在这个漫长的技术演化过程中，
不需要放弃什么，不需要推翻什么，不需要剧烈的革命，就那么润物细无声地把一个只有一台服务器，几百个用户的小网站演化成一个几十万台服务器，数十亿用户的
大网站。

### 1.3.2 驱动大型网站技术发展的主要力量是网站的业务发展

创新的业务发展模式对网站架构逐步提出更高要求，才使得创新的网站架构得以发展成熟。是业务成就了技术，是事业成就了人，而不是相反。

## 1.4 网站架构设计误区

### 1.4.1 一味追随大公司的解决方案

大公司的经验和成功模式固然重要，值得学习借鉴，但如果因此而变得盲从，就失去了坚持自我的勇气，在架构演化的道路上迟早会迷路。

### 1.4.2 为了技术而技术

网站技术是为业务而存在的，除此毫无意义。在技术选型和架构设计中，脱离网站业务发展的实际，一味追求时髦的新技术，可能会将网站技术发展引入崎岖小道，架
构之路越走越难。

### 1.4.3 企图用技术解决所有问题

技术是用来解决业务问题的，而业务的问题，也可以通过业务的手段去解决。

## 1.5 小结

网站架构技术演化过程难以重现，所以网站架构师更应该对这个过程深刻了解，理解已成熟的网站架构技术方案的来龙去脉和历史渊源，在技术选型和架构决策时才能
有的放矢，直击要害。
