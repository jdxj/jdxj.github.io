---
title: "规范"
date: 2023-05-25T23:24:45+08:00
---

# 命名

1. 命名长度

- 作用域大的长点
- 作用域小的短点

2. 利用上下文简化命令

- 属性名可以不加user

```java
public class User {
  private String userName;
  private String userPassword;
  private String userAvatarUrl;
  //...
}
```

- 函数参数

```java
public void uploadUserAvatarImageToAliyun(String userAvatarImageUri);
//利用上下文简化为：
public void uploadUserAvatarImageToAliyun(String imageUri);
```

3. 命名要可读、可搜索

- 大概能读出个音就行
- 大家都用“selectXXX”表示查询，你就不要用“queryXXX”；大家都用“insertXXX”表示插入一条数据，你就要不用“addXXX”

4. 命名接口和抽象类

| 接口           | 实现              |
|--------------|-----------------|
| IUserService | UserService     |
| UserService  | UserServiceImpl |

对于抽象类, 比如`AbstractConfiguration`可以不加`Abstract`

# 注释

1. 写什么

- 做什么
- 为什么
- 怎么做

2. 注释是不是越多越好？

- 类和函数一定要写注释，而且要写得尽可能全面、详细，而函数内部的注释要相对少一些，一般都是靠好的命名、提炼函数、解释性变量、总结性注释来提高代码的
  可读性。

# 代码风格

1. 类、函数多大才合适？

- 对于函数代码行数的最大限制，网上有一种说法，那就是不要超过一个显示屏的垂直高度。
- 对于类的代码行数的最大限制, 当一个类的代码读起来让你感觉头大了，实现某个功能时不知道该用哪个函数了，想用哪个函数翻半天都找不到了，只用到一个小功
  能要引入整个类（类中包含很多无关此功能实现的函数）的时候，这就说明类的行数过多了。

2. 一行代码多长最合适？

- 一行代码最长不能超过 IDE 显示的宽度。需要滚动鼠标才能查看一行的全部代码，显然不利于代码的阅读。

3. 善用空行分割单元块
4. 四格缩进还是两格缩进？

- go中没有这个问题
- 不要用tab

5. 大括号是否要另起一行？

- go中没有这个问题

6. 类中成员的排列顺序

- go中字段顺序影响内存占用(内存对齐)

# 技巧

1. 把大块代码分割成更小的单元块
2. 避免函数参数过多
3. **勿用函数参数来控制逻辑**
   - 不要使用bool参数
   - 不要使用参数是否为null
4. 函数设计要职责单一
5. 移除过深的嵌套层次
6. **学会使用解释性变量**

- 常量取代魔法数字

```java
public double CalculateCircularArea(double radius) {
  return (3.1415) * radius * radius;
}

// 常量替代魔法数字
public static final Double PI = 3.1415;
public double CalculateCircularArea(double radius) {
  return PI * radius * radius;
}
```

- 使用解释性变量来解释复杂表达式

```java
if (date.after(SUMMER_START) && date.before(SUMMER_END)) {
  // ...
} else {
  // ...
}

// 引入解释性变量后逻辑更加清晰
boolean isSummer = date.after(SUMMER_START)&&date.before(SUMMER_END);
if (isSummer) {
  // ...
} else {
  // ...
} 
```

# 代码质量checklist

常规checklist

- 目录设置是否合理、模块划分是否清晰、代码结构是否满足“高内聚、松耦合”？
- 是否遵循经典的设计原则和设计思想（SOLID、DRY、KISS、YAGNI、LOD 等）？
- 设计模式是否应用得当？是否有过度设计？
- 代码是否容易扩展？如果要添加新功能，是否容易实现？
- 代码是否可以复用？是否可以复用已有的项目代码或类库？是否有重复造轮子？
- 代码是否容易测试？单元测试是否全面覆盖了各种正常和异常的情况？
- 代码是否易读？是否符合编码规范（比如命名和注释是否恰当、代码风格是否一致等）？

业务需求checklist

- 代码是否实现了预期的业务需求？
- 逻辑是否正确？是否处理了各种异常情况？
- 日志打印是否得当？是否方便 debug 排查问题？
- 接口是否易用？是否支持幂等、事务等？
- 代码是否存在并发问题？是否线程安全？
- 性能是否有优化空间，比如，SQL、算法是否可以优化？
- 是否有安全漏洞？比如输入输出校验是否全面？
