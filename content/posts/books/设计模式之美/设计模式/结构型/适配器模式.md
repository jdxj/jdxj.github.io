---
title: "适配器模式"
date: 2023-06-05T13:18:56+08:00
cover:
  image: "https://www.oodesign.com/images/structural/adapter-pattern.png"
  caption: ""
summary: Adapter Pattern
---

将不兼容的接口转换为可兼容的接口,
适配器模式是一种事后的补救策略。适配器提供跟原始类不同的接口，而代理模式、装饰器模式提供的都是跟原始类相同的接口。

- 类适配器使用继承关系来实现
- 对象适配器使用组合关系来实现
- ITarget 表示要转化成的接口定义
- Adaptee 是一组不兼容 ITarget 接口定义的接口
- Adaptor 将 Adaptee 转化成一组符合 ITarget 接口定义的接口

```java
// 类适配器: 基于继承
public interface ITarget {
  void f1();
  void f2();
  void fc();
}

public class Adaptee {
  public void fa() { //... }
  public void fb() { //... }
  public void fc() { //... }
}

public class Adaptor extends Adaptee implements ITarget {
  public void f1() {
    super.fa();
  }
  
  public void f2() {
    //...重新实现f2()...
  }
  
  // 这里fc()不需要实现，直接继承自Adaptee，这是跟对象适配器最大的不同点
}

// 对象适配器：基于组合
public interface ITarget {
  void f1();
  void f2();
  void fc();
}

public class Adaptee {
  public void fa() { //... }
  public void fb() { //... }
  public void fc() { //... }
}

public class Adaptor implements ITarget {
  private Adaptee adaptee;
  
  public Adaptor(Adaptee adaptee) {
    this.adaptee = adaptee;
  }
  
  public void f1() {
    adaptee.fa(); //委托给Adaptee
  }
  
  public void f2() {
    //...重新实现f2()...
  }
  
  public void fc() {
    adaptee.fc();
  }
}
```

使用类适配器还是对象适配器?

- 如果 Adaptee 接口并不多，那两种实现方式都可以。
- 如果 Adaptee 接口很多，而且 Adaptee 和 ITarget 接口定义大部分都相同，那我们推荐使用类适配器，因为 Adaptor 复用父类 Adaptee 的接口，比
  起对象适配器的实现方式，Adaptor 的代码量要少一些。(直接拿来用, 选择类适配器)
- 如果 Adaptee 接口很多，而且 Adaptee 和 ITarget 接口定义大部分都不相同，那我们推荐使用对象适配器，因为组合结构相对于继承更加灵活。
  (要重写, 选择对象适配器)

# 应用场景

- 封装有缺陷的接口设计
- 统一多个类的接口设计
- 替换依赖的外部系统
- 兼容老版本接口
- 适配不同格式的数据

# 参考

- [适配器模式-go](https://github.com/senghoo/golang-design-pattern/blob/master/02_adapter/adapter.go)
