---
title: "8086处理器的寻址方式"
date: 2023-08-25T16:01:13+08:00
summary: 处理器的一生，是忙碌的一生，只要它工作着，就必定是在取指令和执行指令。它就像勤劳的牛，吃的是电，挤出来的还是电，不过是另一种形式的电。
tags:
  - x86
  - asm
---

寻址方式就是如何找到要操作的数据，以及如何找到存放操作结果的地方。

# 寄存器寻址

指令执行时，操作的数位于寄存器中

```nasm
mov ax, cx
add bx, 0xf000
inc dx
```

# 立即寻址

又叫立即数寻址。也就是说，指令的操作数是一个立即数

```nasm
add bx, 0xf000
; 标号是数值的等价形式, 代表汇编地址,
; 在编译阶段被转化为一个立即数.
mov dx, label_a
```

# 内存寻址

所谓的内存寻址方式，就是如何在指令中指定操作数的偏移地址，供处理器访问内存时使用，这个偏移地址也叫有效地址(Effective Address, EA)。换句话
说，内存寻址方式就是在指令中指定偏移地址（有效地址）如何计算。

## 直接寻址

偏移地址或者说有效地址是直接给出的，是一个用标号或者数字直接给出的具体数值。

```nasm
mov ax, [0x5c0f]; ds
add word [0x0230], 0x5000; ds
xor byte [es:label_b], 0x05
```

## 基址寻址

先指定一个基准位置，数据的偏移地址（有效地址）取决于它到基准位置的位移或者说距离(Displacement)。

要使用基址寻址的话，必须在指令的地址部分使用基址寄存器BX或者BP来提供一个基准地址。

```nasm
mov [bx], dx; ds
add byte [bx], 0x55; ds
```

基址寻址的动机是采用“基地址+位移”的方式计算有效地址

```nasm
buffer dw 0x20, 0x100, 0x0f, 0x300, 0xff00
mov bx, buffer
inc word [bx]
inc word [bx + 2]
inc word [bx + 4]
...
```

在基址寻址方式中，基址寄存器也可以是BP

```nasm
mov ax, [bp]; ss
mov dx, [bp - 2]
```

在基址寻址方式中，基地址原则上是固定不变的。换句话说，通常不改变BX和BP，而是在BX和BP的基础上加一个位移。但是，有时候为了方便，可以通过增加
BX和BP的方式来访问数据，这可以看成在操作的过程中动态设置新的基地址。

![](https://res.weread.qq.com/wrepub/CB_3300050845_txt010_39.jpg)

## 变址寻址

变址寻址类似于基址寻址，唯一不同之处在于这种寻址方式使用的是变址寄存器（或称索引寄存器）SI和DI。

```nasm
mov [si], dx; ds
add ax, [di]; ds
xor word [si], 0x8000

mov [si + 0x100], al
and byte [di + label_a], 0x80
```

## 基址变址寻址

使用基址变址的操作数可以使用一个基址寄存器（BX或者BP），外加一个变址寄存器（SI或者DI）。

```nasm
mov ax, [bx + si]; ds
add word [bx + di], 0x3000; ds
```

![](https://res.weread.qq.com/wrepub/CB_3300050845_txt010_46.jpg)

基址变址寻址允许在基址寄存器和变址寄存器的基础上再带一个位移，但它必须是一个数值。

```nasm
mov [bx + si + 0x100], al
and byte [bx + di + label_a], 0x80
```
