---
title: "滑动窗口"
date: 2023-04-09T11:43:02+08:00
tags:
  - tcp
---

# TCP 包状态分类

![](https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/3/10/16968005b1f1b27a~tplv-t2oaga2asx-zoom-in-crop-mark:3024:0:0:0.awebp)

- 粉色部分#1 (Bytes Sent and Acknowledged)：表示已发送且已收到 ACK 确认的数据包。
- 蓝色部分#2 (Bytes Sent but Not Yet Acknowledged)：表示已发送但未收到 ACK 的数据包。发送方不确定这部分数据对端有没有收到，如果在一段时间内没有收到 ACK，发送端需要重传这部分数据包。
- 绿色部分#3 (Bytes Not Yet Sent for Which Recipient Is Ready)：表示未发送但接收端已经准备就绪可以接收的数据包（有空间可以接收）
- 黄色部分#4 (Bytes Not Yet Sent，Not Ready to Receive)：表示还未发送，且这部分接收端没有空间接收

# 发送窗口（send window）与可用窗口（usable window）

- 发送窗口是 TCP 滑动窗口的核心概念，它表示了在某个时刻一端能拥有的最大未确认的数据包大小（最大在途数据），发送窗口是发送端被允许发送的最大数据包大
  小，其大小等于上图中 #2 区域和 #3 区域加起来的总大小
- 可用窗口是发送端还能发送的最大数据包大小，它等于发送窗口的大小减去在途数据包大小，是发送端还能发送的最大数据包大小，对应于上图中的 #3 号区域

窗口的左边界表示成功发送并已经被接收方确认的最大字节序号，窗口的右边界是发送方当前可以发送的最大字节序号，滑动窗口的大小等于右边界减去左边界。

![](https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/3/10/16968005b25d3742~tplv-t2oaga2asx-zoom-in-crop-mark:3024:0:0:0.awebp)

# TCP Zero Window

零窗口探测包其实就是一个 ACK 包

![](https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/3/11/1696d4564ca57929~tplv-t2oaga2asx-zoom-in-crop-mark:3024:0:0:0.awebp)



