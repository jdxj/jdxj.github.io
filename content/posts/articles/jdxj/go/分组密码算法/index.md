---
title: "分组密码算法"
date: 2023-06-22T01:07:56+08:00
tags:
  - go
  - crypto
---

密码算法可以分为分组密码（block cipher）和流密码（stream cipher）两种。

分组密码是一种一次仅能处理固定长度数据块的算法。而这个数据块的固定长度（比特数量）则称为该分组密码算法的分组长度（block length）。

图55-1　分组密码加密流程

![](https://res.weread.qq.com/wrepub/epub_42557147_54)

填充方案

- ISO10126：填充字符串由一个字节序列组成，该字节序列的最后一个字节标识填充字节序列的长度，序列中的其余字节为随机数据。
- PKCS#7：填充字符串由一个字节序列组成，该序列中每字节的值都是该填充字节序列的长度。该方案适合分组长度为1～255字节的情况。
- PKCS#5：该填充方案和PKCS#7方案原理上没有实质区别，只是它仅适合分组长度为8字节的情况。（该方案不适合AES算法，因为该算法的分组长度至少为16字节。）
- 由0x80和0x00组成的填充字节序列：在这种填充方式中，填充字符串的第一个字节值是0x80，后面的每个字节值都是0x00。

迭代的方法称为分组密码算法的模式。常见的模式包括

- ECB模式（电子密码本模式）
- CBC模式（密码分组链接模式）
- CFB模式（密文反馈模式）
- OFB模式（输出反馈模式）
- CTR模式（计数器模式）

图55-2　ECB模式与CBC模式对比

![](https://res.weread.qq.com/wrepub/epub_42557147_55)

CBC模式第一个明文分组由于不存在前一个密文分组，因此使用了一个被称为“初始向量”（initialization vector, IV）的随机数据。这个初始向量在解密时也
会被用到，因此加密方和解密方需事先就初始向量的生成方式达成一致。比如：一种惯用法是将初始向量字符串包含在密文的头部，长度为分组长度。

不同分组密码迭代模式有各自的优缺点。从安全性考虑，ECB模式（电子密码本）虽然简单、快速，但不应在生产中使用，因为它对攻击的抵御能力是这些模式中最弱
的。

Go语言实现的DES、3重DES（TDEA）和AES算法都是对称密码算法。在这三个算法中

- DES已经可以用暴力破解手段在现实时间内实现破解，因此我们不应再将DES算法应用在实际生产中；
- 3重DES加解密性能不高，仅在一些重视兼容性（与DES兼容）的场合有所应用；
- AES是标准机构NIST公开选拔的、用于取代DES的新对称密码标准，它安全快速，可以在各种平台上工作，是对称密码算法的首选

# 使用AES加密

{{< embedcode go "block_cipher.go" >}}
